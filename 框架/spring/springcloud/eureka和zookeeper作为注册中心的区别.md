
* 1：zookeeper 作用：zookeeper是hadoop下的一个子项目，旨在解决大规模分布式应用场景下，服务协调同步的问题，它可以为同一个分布式系统中的其他服务提供：统一命名，配置管理，分布式锁服务，集群管理等功能。
* 2：zookeeper 的劣势 在分布式系统领域中有个著名的CAP定律（C-数据一致性；A-服务可用性；P-服务对网络分区故障的容错性）这三个特定在任何分布式系统中都不能同时满足，最多同事满足2个。zookeeper是CP的。即任何时刻对zookeeper的访问请求
能得到一致的数据结果，同时系统对网络分区具有容错性；但是它不保证每次服务请求都是可用的。极端环境下，zookeeper会丢弃一些请求，消费者端需要重新请求才能得到结果（zookeeper为什么不设计成AP的？）。作
为zookeeper的核心算法Zab（zookeeper  Atomic Broadcast，全称：原子消息广播协议），就是解决了分布式系统下数据如何在多个服务之间保持同步问题的。    zookeeper 下所有节点不可能保证任何时候都能缓存所有的服务注册信息。如果zookeeper下所有的节点都断开了，或者集群中出现了网络分割的故障，那么zookeeper将会把他们从自己的管理范围内踢除，外界就不能访问到这些节点了，
即使这些节点本身是健康的可以正常提供服务，所以导致到达这些节点的服务请求被丢失了。
* 3：Eureka的优势       在Eureka平台中，如果某台服务器宕机，Eureka不会像zookeeper选择leader的过程，客户端请求会自动切换到新的Eureka节点，当宕机的服务器重新恢复后，Eureka会再次将其纳入到服务器集群管理中，而对于它而言，
所有要做的无非是同步一些新的服务注册信息。所以不用担心“掉队”的服务器恢复以后，会从Eureka服务器集群中踢除的风险。Eureka甚至被设计用来应付范围更广的网络分割故障，并实现0宕机维护需求。（多个zookeeper之间
网络出现问题，造成出现多个leader，发生脑裂），当网络分割故障发生时，每个Eureka节点，会持续的对外提供服务（zookeeper不会）接收新的服务注册同时将它们提供下游的服务发现请求，这样一来，就可以实现在同一个子
网中，新发布的服务仍然可以被发现与访问。

#####   Eureka还有客户端缓存功能（Eureka分为客户端程序与服务端程序两个部分，客户端程序负责向外提供注册与发现服务接口）所以即便Eureka集群中所有节点都失效，或者发生网络分割故障导致客户端不能访问任何一台
Eureka服务器；Eureka服务的消费者仍然可以通过Eureka客户端缓存来获取现有的服务注册信息。甚至最极端的环境下，所有正常的Eureka节点都不对请求产生相应，也没有更好的服务器解决方案来解决这种问题时；得
益于Eureka的客户端缓存技术，消费者服务仍然可以通过Eureka客户端查询与获取注册服务信息，这点很重要。


--------------------


### 一、首先介绍下CAP
   RDBMS(mysql/oracle/sqlServer)   ----->   ACID
   NOSQL(redis/mongdb)  ---->  CAP   
       ACID：A（atomicity）原子性  C（Consistency）一致性
            I（Isolation）独立性    D（Durability）持久性
       CAP：  C（Consistency）强一致性  A（Availability） 可用性  
             P（Partition tolerance）分区容错性
       CAP的3进2：
         最多只能同时较好的满足两个。
         CAP理论的核心是：一个分布式系统不可能同时很好的满足一致性，可用性和
          分区容错性这三个需求。
         因此，根据CAP原理将NoSQL数据库分成了满足CA原则、满足CP原则
           和满足AP原则三大类；
    CA-单点集群，满足一致性，可用性的系统，通常在课扩展性上不太强大。
    CP-满足一致性，分区容错性的系统，通常性能不是特别高。
    AP-满足可用性，分区容错性的系统，通常可能对一致性要求低一些。      
      
    CAP理论就是说在分布式存储系统中，最多只能实现上面的两点。而由于当前的网络
  硬件肯定会出现延迟丢包等问题，所以分区容错性是我们必须要实现的。
  所以我们只能在一致性和可用性之间进行权衡，没有NoSQL系统能同时保证这三点。

### 二、Eureka 和 Zookeeper区别？
 * 1.Eureka是遵守AP原则
   Zookeeper是遵守CP原则    
   Zookeeper保证CP原则：
     1.1当向注册中心查询服务列表时，我们可以容忍注册中心返回的是几分钟以前的注册信息，
 但不能接受服务直接down掉不可用。也就是说，服务注册功能对可用性的要求高于一致性。
 但是zk会出现这一种情况，当master节点因为网络故障与其他节点失去联系时，剩余注册
 功能就会重新进行leader选举看。问题在于，选举leader的时间太长，30~120s，且选举期间
 整个zk集群都是不可用的，这就导致在选举期间注册服务瘫痪。在云部署的环境下，因网络问题
 使得zk集群失去master节点是较大概率会发生的事，虽然服务能够最终恢复，但是漫长的
 选举时间导致的注册长期不可用是不能容忍的。
    1.2Eureka看明白了这一点，因此在设计时就优先保证可用性。Eureka各个节点都是平等
 的，几个节点挂掉不会影响正常节点的工作，剩余节点依然可以提供注册和查询服务。
 而Eureka的客户端在向某个Eureka注册或者如果发现链接失败时，则会自动切换至其他节点，
 只要有一台Eureka还在，就能保证注册服务可用（保证可用），只不过查到的信息可能不是
 最新的（不保证一致性）。除此以外，Eureka还有一种自我保护机制，如果在15分钟内超过85%
 的节点都没有正常的心跳，那么Eureka就认为客户端与注册中心出现了网络故障，此时会出现
 一下几种情况：
   （1）Eureka不在从注册列表中移除因为长时间没收到心跳而应该过期的服务
   （2）Eureka仍然能够接受新服务的注册和查询请求，但是不会被同步到其他节点上
        （保证当前节点依然可用）
   （3）当网络稳定时，当前实例新的注册信息会被同步到其他节点中
 因此，Eureka可以很好的应对因网络故障导致部分节点失去联系的情况，而不会像zk那样
   是整个注册服务瘫痪。
